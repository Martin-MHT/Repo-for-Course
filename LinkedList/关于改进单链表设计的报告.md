# 关于改进单链表设计的报告

## 1. 对 $\text{emptyList}$ 的改进
原有的 _emptyList 方法没有同时将 size、currentPos 清空，而这应当是任意一次清空链表的时候都需要做的，所以我把这个工作放到了函数中。

## 2. 对 $\text{remove}$ 的改进
原来的设计中，调用 remove 方法将会移除 currentPos 指针之后的元素，这在实际使用的时候是很反直觉的。根据用户朴素的认知，应当能够对于当前位置进行删除。这需要我们对设计进行改进。

我们知道不能删除当前元素的障碍在于链表的设计是单向的，我们无法得知上一个元素的指针，因此也就无法将上一个元素指向新的位置。一个朴素的改进思路是从 head 指针再次向后寻找前一个位置的指针。然而，这样的设计违背了我们设计链表这一数据结构的初衷：希望 insert 和 remove 操作能够在 $\Theta(1)$ 的时间复杂度内完成。

还有一个思路是对于每一个元素，多记录一个向前的指针 pre。但是，这样一来我们设计的就是双向链表了。

我采取的方法是随着 currentPos 的移动，动态地同时维护它的前驱指针 prePos，这样一来，上述的问题都可以得到解决。

整个维护的思路并不困难，工作量在于需要对所有涉及 currentPos 的函数进行修改。需要特殊处理的地方是，删除 head 指针的时候 prePos 是空指针，我们不需要进行操作。

## 3. 对于异常的处理

在 setCurrentVal 和 getCurrentVal 的方法中，需要对于异常情况进行处理。在异常情况发生，程序输出错误信息之后，需要结束整个程序。此时，不应该使用 C 语言中的 exit(0) 来结束程序，因为这会导致程序跳过析构过程直接结束，造成内存泄漏。一个更好的做法是采用 C++ 的 try-catch-throw 流程，具体实现方法已经在程序中展示。

 
## 4. 新的测试程序
在修改设计之后，原有的测试代码已经不可用。我为新的设计框架设计了新的测试程序，放在了同目录下的 main.cpp 中。经过测试，所有的输出都符合预期，内存也没有泄露。